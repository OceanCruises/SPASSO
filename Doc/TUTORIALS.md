# SPASSO tutorials

The following is a set of tutorials to help users to get more familiar with SPASSO
and how to change parameters and options from the config.ini file. All the examples
below starts from the most simple and standard configuration example WMedSeaExample.

> Users can find full description of the parameters defined in the config.ini file [here](https://github.com/OceanCruises/SPASSO/blob/main/config.ini)

#### Table Of Contents

[Standard SPASSO run](#standard-spasso-run)

[Other pre-defined satellite fields](#other-pre-defined-satellite-fields)

[Other Lagrangian diagnostics](#other-lagrangian-diagnostics)

[Plot options](#plot-options)

## Standard SPASSO run
- Run standard SPASSO config (in a terminal window):
```
local@ubuntu: vi spasso2.0/Cruises/WMedSeaExample/config_WMedSeaExample.ini
    > modify Library paths (L 322-324)
local@ubuntu: cd spasso2.0/src/
local@ubuntu: clear; python3 Spasso.py WMedSeaExample
```
> Spasso.py needs as an argument the name of the cruise. It is indispensable that
> the name of the cruise is <ins>exactly</ins> (i.e. case sensitive) in the repository
> and config_*.ini names. One can also define the cruise name in a variable `cr` and
> call it using `python3 Spasso.py $cr`

- Information about the run are printed on screen:
<img src="https://github.com/user-attachments/assets/7bec355f-c73e-419a-b267-92acbc45929b" width="500">


- Several directories are created in the cruise folder:
    - Bulletin: where bulletin file are stored
    - Figures: where all figures outputs are stored
    - Logs: where log files are saved
    - Processed: where netcdf files are saved
    - Wrk: the working directory. Users can check the current SPASSO run outputs there.
> Each time a new run is launched the working directory is cleaned but do not worry all files from previous run are saved in Bulletin, Figures, Processed and Logs directories.

- Figures generated by this config:
<img src="https://github.com/user-attachments/assets/afd4a7e5-f38e-48a3-9f3e-09c72dc12cd8" width="500">
<img src="https://github.com/user-attachments/assets/00d07569-34d1-435e-9f77-7622105ba3a0" width="480">
<img src="https://github.com/user-attachments/assets/6a196f43-e989-4b01-a162-210271c3d2b3" width="500">
<img src="https://github.com/user-attachments/assets/1007873f-82d5-4349-9eb1-f639e27e787b" width="500">
<img src="https://github.com/user-attachments/assets/7919434c-0750-4c8e-9c1a-52d064c22b64" width="500">
<img src="https://github.com/user-attachments/assets/0ce75ae6-75f7-49b0-88da-5ade3e7a5c8e" width="500">
<img src="https://github.com/user-attachments/assets/23dc211b-fde1-4938-8c91-49ee8553d4a9" width="500">

## Other pre-defined satellite fields
- In the `config_WMedSeaExample.ini`, users can find a list of other pre-defined satellite products that can be used. By modifying the list of `products` users can add/remove pre-defined satellite products to SPASSO run:
    <img src="https://github.com/user-attachments/assets/8f0aaff7-8447-425e-b154-f7dd3609b127" width="500">
    - PHYTOT: Global NRT total currents (geostrophy + ekman). [DOI]( https://doi.org/10.48670/mds-00327)
    <img src="https://github.com/user-attachments/assets/f7bc1d44-a3c0-4d32-b097-7a7b84203160" width="200">
    
    - PHYEURO: European NRT Level-4 SSH and geostrophic currents. [DOI](https://doi.org/10.48670/moi-00142)
    <img src="https://github.com/user-attachments/assets/1b7ea27b-b4d2-4214-91fe-b8c4b7bb1b2b" width="200">
    
    - PHY_WIND: Hourly NRT Level-4 sea surface wind and stress fields. [DOI](https://doi.org/10.48670/moi-00305)
    <img src="https://github.com/user-attachments/assets/00c4d98d-96b2-4eed-9a8d-07a917957925" width="200">

    - CHL_L3: Global chlorophyll-a NRT Level-3. [DOI](https://doi.org/10.48670/moi-00278)
    <img src="https://github.com/user-attachments/assets/2cc416ed-bcdc-4360-8b53-680fb806035c" width="200">

    - CHL_L4_DT: Global chlorophyll-a DT Level-4. [DOI](https://doi.org/10.48670/moi-00281)
    <img src="https://github.com/user-attachments/assets/0be861cd-acc0-4ba0-afd3-bfde94f825eb" width="200">

    - CHL_BAL: Regional Baltic Sea chlorophyll-a NRT Level-3. [DOI](https://doi.org/10.48670/moi-00294)
    <img src="https://github.com/user-attachments/assets/d3c183cb-03b6-4a6a-95db-6fe6fb59b29f" width="200">

    - MEDSEA_WAVF: Wave product of the Mediterranean Sea Forecasting System. [DOI](https://doi.org/10.25423/cmcc/medsea_analysisforecast_wav_006_017_medwam4)

    <img src="https://github.com/user-attachments/assets/747c92b9-f44e-426f-97db-07748a82da18" width="200"><img src="https://github.com/user-attachments/assets/68e26453-d5bc-4b69-a76b-ca2af633577f" width="200">
    <img src="https://github.com/user-attachments/assets/fc22e7b9-692d-407e-9c4e-31a7057242ec" width="200"><img src="https://github.com/user-attachments/assets/ef80ee60-35d3-459f-91da-884531c44d57" width="200">

## Other Lagrangian diagnostics
- In the `config_WMedSeaExample.ini`, users can also find a list of other pre-defined Lagrangian diagnostics to compute. Please visit the [LAMTA github page](https://github.com/rousseletL/lamtaLR)  and the [Rousselet et al. (in rev)](https://hal.science/hal-04705438v1) for specific details on the Lagrangian diagnostics.

    <img src="https://github.com/user-attachments/assets/dc41bca6-533c-42f3-b672-9b74a3ad0e2f" width="300">
    
    - LLADV: Longitude/Latitude advection.
    
    <img src="https://github.com/user-attachments/assets/7ed1754f-80c9-4e6d-a4c9-17634eaf4d38" width="200"><img src="https://github.com/user-attachments/assets/dbd243e6-d467-4c64-92af-7f647c0b4c86" width="200">

    - OWTRAJ: Retention parameter based on Okubo-Weiss parameter.
 
    <img src="https://github.com/user-attachments/assets/c6e4a4b1-60cb-4b9f-a286-240e10ae8e22" width="200">

    - TIMEFROMBATHY: Time elapsed since last contact with bathymetry.
> To run this diagnostic users must download the ETOPO file from [NOAA]{https://www.ngdc.noaa.gov/thredds/catalog/global/ETOPO2022/30s/30s_bed_elev_netcdf/catalog.html?dataset=globalDatasetScan/ETOPO2022/30s/30s_bed_elev_netcdf/ETOPO_2022_v1_30s_N90W180_bed.nc}.
> The file should by stored in the BATHY/ folder. The name of the netcdf file should be defined in the config_WMedSeaExample.ini (L 140: bathyfile)

    <img src="https://github.com/user-attachments/assets/83395149-986b-4963-ab80-97fd022c8aaf" width="200"><img src="https://github.com/user-attachments/assets/917157a4-c979-4204-8b68-49819589184d" width="200"><img src="https://github.com/user-attachments/assets/cf56c798-b4bc-44eb-b11d-6567ec2367c9" width="200">

    - SSTADV: Advection of SST field.

    <img src="https://github.com/user-attachments/assets/4d761f29-10e4-4626-8482-65904e1bbd42" width="200">


> The satellite product used to compute the Lagrangian (and Eulerian) diagnostics <ins>MUST</ins> be defined in `products =` both in the `[products]` and `[Lagrangian]` sections. 

## Plot options
Several basic options, defined in the `config_WMedSeaExample.ini`, can be ploted on each SPASSO figures (L 273).
- Station, waypoint positions:
  ```
  [plot_options]
  options = stations,waypoints
  ```
  > The details of each `options` are defined in corresponding sections.

    <img src="https://github.com/user-attachments/assets/22a49148-96e8-4048-a75e-e282842765d1" width="200">

- Glider trajectories from file:\
  :warning: Example not reproducible because glider data cannot be shared. However this example illustrates how SPASSO can read glider netcdf files and plot glider trajectories.

    <img width="300" alt="Screenshot 2025-01-24 at 9 51 52â€¯AM" src="https://github.com/user-attachments/assets/7aa96146-d455-4448-880e-0f9020676b4b" /><br/>
    
    <img src="https://github.com/user-attachments/assets/6b09f865-d79d-44a1-b73f-af7cfb35b17a" width="200">


- Output figure options:\
  Default figure output format is png but users can require kml output format to open figures in Google Earth (L 276).
  ```
  [plot_options]
  options             = 
  outopt              = kml
  ```
> When kml option is set, figures are still saved in png.
